<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pizza: spicchi uguali per sommare (MCM)</title>
<style>
  /* ====== A4 & base ====== */
  @page { size: A4; margin: 12mm; }
  :root{
    --ink:#0f172a; --bg:#f7f9ff; --card:#fff; --grid:#dbe3ef; --line:#93a7bd55;
    --a:#2563eb; --b:#16a34a; --good:#0a7d32; --bad:#b91c1c;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink); background:var(--bg);
    font-family: system-ui, Segoe UI, Roboto, Arial;
    font-size:18px; line-height:1.25;
  }
  .page{
    width: 186mm;  /* 210 - 12 - 12 */
    margin: 0 auto; padding: 6mm 0;
  }

  /* ====== Tipografia ====== */
  .title{font-size: 28px; font-weight: 900; text-align:center; margin:0 0 6mm}
  .task{
    font-size: 22px; font-weight: 800; text-align:center;
    background:var(--card); border:1px solid var(--grid); border-radius:12px;
    padding:8px 10px; margin:0 0 4mm;
  }
  .guide{
    text-align:center; font-size: 18px; font-weight: 700; color:#0b3a6f; margin:0 0 5mm;
  }

  /* ====== Griglia principale ====== */
  .row{display:flex; gap:8mm; align-items:center; justify-content:center; flex-wrap:wrap}
  .col{flex:1 1 80mm; display:flex; flex-direction:column; align-items:center}

  /* ====== Pizze grandi con griglia ====== */
  .pizza{
    width: 75mm; height: 75mm; border-radius:50%;
    border: 4mm solid #eef2f7; box-shadow: 0 2px 6px rgba(0,0,0,.05);
    position: relative; background:#e5ecf6;
  }
  .label{font-size:20px; font-weight:800; margin-top:3mm}
  .legend{display:flex; gap:4mm; justify-content:center; margin:3mm 0 0}
  .chip{display:inline-flex; gap:4mm; align-items:center; padding:2mm 4mm; border:1px solid var(--grid); border-radius:999px; background:#fff; font-weight:700}
  .dot{width:10px; height:10px; border-radius:50%}
  .dot.a{background:var(--a)} .dot.b{background:var(--b)}

  /* ====== Scelta numerica super-visibile ====== */
  .choices{display:grid; grid-template-columns: repeat(5, 1fr); gap:4mm; margin: 6mm 0 4mm}
  .choice{
    font-size:24px; font-weight:900; padding:6mm 0; background:#fff; border:2px solid var(--grid);
    border-radius:12px; cursor:pointer; text-align:center; user-select:none;
  }
  .choice:active{transform:scale(.98)}
  .choice.good{border-color:var(--good)}
  .choice.bad{border-color:var(--bad)}
  .msg{font-size:20px; font-weight:900; text-align:center; min-height:10mm}
  .ok{color:var(--good)} .err{color:var(--bad)}

  /* ====== Barra somma ====== */
  .eq{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:22px; text-align:center}
  .bar{height:10mm; border-radius:999px; border:1px solid var(--grid); overflow:hidden; background:#eef3fb}
  .seg{height:100%}

  /* Spiegazione micro (pratica) */
  .why{background:#fffaf2; border:1px solid #f4e4c3; border-radius:12px; padding:3mm; font-weight:800; text-align:center; margin: 2mm 0 0}
  .mini{font-size:18px}

  /* ====== Pulsanti azione ====== */
  .actions{display:flex; gap:4mm; justify-content:center; margin-top:5mm}
  .btn{
    font-size:20px; font-weight:800; padding:4mm 6mm; border:2px solid var(--grid); background:#fff; border-radius:999px; cursor:pointer
  }

  /* ====== Step (semplicità) ====== */
  .hidden{display:none}

  /* ====== Stampa: niente ombre, colori pieni ====== */
  @media print{
    body{background:#fff}
    .pizza{box-shadow:none}
    .choice, .btn{filter:none}
  }
</style>
</head>
<body>
<div class="page">

  <h1 class="title">Sommare 1/2 e 1/3: servono spicchi uguali</h1>

  <p class="task" id="task">
    Mettiamo sullo stesso piatto <b>1/2 pizza</b> (A) e <b>1/3 pizza</b> (B). <u>In quanti spicchi uguali</u> tagliamo la pizza per poterle sommare?
  </p>
  <p class="guide" id="guide">Tocca il numero degli spicchi. Devono andare bene per <b>A</b> e per <b>B</b>.</p>

  <!-- Pizze grandi -->
  <div class="row">
    <div class="col">
      <div class="pizza" id="pieA" aria-label="Pizza A 1/2"></div>
      <div class="label">A = 1/2</div>
    </div>
    <div class="col">
      <div class="pizza" id="pieB" aria-label="Pizza B 1/3"></div>
      <div class="label">B = 1/3</div>
    </div>
  </div>

  <!-- Scelte numeriche grandi -->
  <div class="choices" role="group" aria-label="Scegli il numero di spicchi">
    <div class="choice" data-n="2">2</div>
    <div class="choice" data-n="3">3</div>
    <div class="choice" data-n="4">4</div>
    <div class="choice" data-n="5">5</div>
    <div class="choice" data-n="6">6</div>
  </div>
  <div class="msg" id="msg1"></div>

  <!-- Spiegazione pratica (micro) -->
  <div class="why">
    <span class="mini">Spicchi uguali = stessa grandezza. Così conti i pezzi e li sommi senza “barare”.<br/>Con <b>6 spicchi</b>, 1/2 diventa <b>3/6</b> e 1/3 diventa <b>2/6</b>: parlano la stessa lingua.</span>
  </div>

  <!-- STEP 2: denominatore comune -->
  <div id="s2" class="hidden" style="margin-top:6mm">
    <p class="eq" id="eq2">1/2 ⟶ 3/6  1/3 ⟶ 2/6</p>
    <div class="row" style="gap:6mm">
      <div class="col" style="flex:1 1 80mm">
        <div class="label">A in 6 spicchi</div>
        <div class="bar"><div class="seg" id="barA" style="width:50%; background:var(--a)"></div></div>
      </div>
      <div class="col" style="flex:1 1 80mm">
        <div class="label">B in 6 spicchi</div>
        <div class="bar"><div class="seg" id="barB" style="width:33.333%; background:var(--b)"></div></div>
      </div>
    </div>
    <div class="actions">
      <button class="btn" id="goJoin">Metti insieme</button>
      <button class="btn" id="back1">Indietro</button>
    </div>
  </div>

  <!-- STEP 3: somma -->
  <div id="s3" class="hidden" style="margin-top:6mm">
    <p class="eq" id="eq3">3/6 + 2/6 = <b>5/6</b></p>
    <div class="bar"><div class="seg" id="barSum" style="width:83.333%; background:linear-gradient(90deg, var(--a) 0 60%, var(--b) 60% 100%)"></div></div>
    <p class="msg ok">Risultato: <b>5 spicchi su 6</b> nello stesso piatto.</p>
    <div class="actions">
      <button class="btn" id="retry">Ricomincia</button>
    </div>
  </div>

</div>

<script>
/* ====== Visuale “pizza” con griglia ====== */
function pieFill(parts, fillParts, color){
  const step = 360/parts, end = step*fillParts;
  return `conic-gradient(${color} 0 ${end}deg, #e5ecf6 ${end}deg 360deg)`;
}
function pieGrid(parts){
  const step = 360/parts, thin = Math.max(0.8, 360/(parts*180));
  return `repeating-conic-gradient(from 0deg, transparent 0 ${step-thin}deg, var(--line) ${step-thin}deg ${step}deg)`;
}
function drawPizza(el, parts, fillParts, color){
  el.style.background = `${pieFill(parts, fillParts, color)}, ${pieGrid(parts)}`;
}

const css = getComputedStyle(document.documentElement);
const pieA = document.getElementById('pieA');
const pieB = document.getElementById('pieB');
// Step iniziale: frazioni originali senza griglia comune
pieA.style.background = pieFill(2,1, css.getPropertyValue('--a'));
pieB.style.background = pieFill(3,1, css.getPropertyValue('--b'));

/* ====== Stato / elementi ====== */
const choices = Array.from(document.querySelectorAll('.choice'));
const msg1 = document.getElementById('msg1');
const s2 = document.getElementById('s2');
const s3 = document.getElementById('s3');
const eq2 = document.getElementById('eq2'), eq3 = document.getElementById('eq3');
const barA = document.getElementById('barA'), barB = document.getElementById('barB'), barSum = document.getElementById('barSum');

function goStep1(){
  s2.classList.add('hidden');
  s3.classList.add('hidden');
  pieA.style.background = pieFill(2,1, css.getPropertyValue('--a'));
  pieB.style.background = pieFill(3,1, css.getPropertyValue('--b'));
}

choices.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const n = parseInt(btn.dataset.n,10);
    const ok = (n%2===0)&&(n%3===0); // multiplo di 2 e 3 → 6
    choices.forEach(b=>b.classList.remove('good','bad'));
    if(ok){
      btn.classList.add('good');
      msg1.className = 'msg ok';
      msg1.textContent = 'Giusto: con 6 spicchi A e B coincidono.';
      drawPizza(pieA, 6, 3, css.getPropertyValue('--a'));
      drawPizza(pieB, 6, 2, css.getPropertyValue('--b'));
      eq2.textContent = '1/2 ⟶ 3/6  1/3 ⟶ 2/6';
      barA.style.width = (3/6*100)+'%';
      barB.style.width = (2/6*100)+'%';
      s2.classList.remove('hidden');
      s3.classList.add('hidden');
      window.scrollTo({top: document.body.scrollHeight, behavior:'smooth'});
    }else{
      btn.classList.add('bad');
      msg1.className = 'msg err';
      drawPizza(pieA, n, Math.round(n/2), css.getPropertyValue('--a'));
      drawPizza(pieB, n, Math.round(n/3), css.getPropertyValue('--b'));
      if(n%2!==0 && n%3!==0) msg1.textContent = 'No: non va bene per 1/2 né per 1/3.';
      else if(n%2!==0)       msg1.textContent = 'No: non va bene per 1/2.';
      else                   msg1.textContent = 'No: non va bene per 1/3.';
      setTimeout(()=>{ if(s2.classList.contains('hidden') && s3.classList.contains('hidden')) goStep1(); }, 900);
    }
  });
});

document.getElementById('goJoin').addEventListener('click', ()=>{
  eq3.innerHTML = '3/6 + 2/6 = <b>5/6</b>';
  barSum.style.width = (5/6*100)+'%';
  s3.classList.remove('hidden');
  window.scrollTo({top: document.body.scrollHeight, behavior:'smooth'});
});
document.getElementById('back1').addEventListener('click', goStep1);
document.getElementById('retry').addEventListener('click', ()=>{
  choices.forEach(b=>b.classList.remove('good','bad'));
  msg1.textContent = ''; goStep1();
});
</script>
</body>
</html>
